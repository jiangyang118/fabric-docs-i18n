

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>链码开发者教程 &mdash; hyperledger-fabricdocs master documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="视频" href="videos.html" />
    <link rel="prev" title="&lt;no title&gt;" href="config_update.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          


          
            <a href="index.html" class="icon icon-home"> hyperledger-fabricdocs
          

          
          </a>

          
            
            
              <div class="version">
                master
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          

<br><img style="background-color: #fff; height: unset; width: unset;" alt="Hyperledger Fabric" src=_images/hyperledger_fabric_logo_color.png />
<br>
<a href="https://github.com/hyperledger/fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="GitHub" src="_static/images/github_button.png"/></a>
&nbsp;<a href="https://stackoverflow.com/questions/tagged/hyperledger-fabric"><img style="padding: 0px; margin: auto auto auto auto;" alt="StackOverflow" src="_static/images/stackoverflow_button.png"/></a>
&nbsp;<a href="https://chat.hyperledger.org"><img style="padding: 0px; margin: auto auto auto auto;" alt="Rocket Chat" src="_static/images/rocketchat_button.png"/></a>
&nbsp;<a href="https://www.youtube.com/playlist?list=PL0MZ85B_96CH7wvtrRzV7SvtRY0sI0DEg"><img style="padding: 0px; margin: auto auto auto auto;" alt="Youtube Channel" src="_static/images/youtube_button.png"/></a>

        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whatsnew.html">Hyperledger Fabric v2.0 更新说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="whatsnew.html#id7">发行说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_concepts.html">关键概念</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="developapps/developing_applications.html">开发应用</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="tutorials.html">教程</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="test_network.html">##### Generate certificates using cryptogen tool #########</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_network.html#create-org1-identities">############ Create Org1 Identities ######################</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy_chaincode.html">}</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy_chaincode.html#id12">}</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy_chaincode.html#id21">}</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy_chaincode.html#id24">}</a></li>
<li class="toctree-l2"><a class="reference internal" href="deploy_chaincode.html#id43">}</a></li>
<li class="toctree-l2"><a class="reference internal" href="write_first_app.html">编写你的第一个应用</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial/commercial_paper.html">}</a></li>
<li class="toctree-l2"><a class="reference internal" href="private_data_tutorial.html">在 Fabric 中使用私有数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="couchdb_tutorial.html">使用 CouchDB</a></li>
<li class="toctree-l2"><a class="reference internal" href="create_channel/create_channel_overview.html">创建通道</a></li>
<li class="toctree-l2"><a class="reference internal" href="channel_update_tutorial.html">向通道添加组织</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">链码开发者教程</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">链码是什么?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#chaincode-api">Chaincode API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#simple-asset-chaincode">简单资产链码</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">选择一个位置存放代码</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">内务</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">初始化链码</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id8">调用链码</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id9">实现链码应用程序</a></li>
<li class="toctree-l4"><a class="reference internal" href="#chaincode-sample">把它们组合在一起</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id12">链码访问控制</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vendoring">管理 Go 链码的扩展依赖</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="videos.html">视频</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deployment_guide_overview.html">部署一个生产网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops_guide.html">操作指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="upgrade.html">升级到最新版本</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_ref.html">命令参考</a></li>
<li class="toctree-l1"><a class="reference internal" href="architecture.html">架构参考</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fabric-FAQ.html">常见问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">欢迎贡献！</a></li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">术语表</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">版本发布</a></li>
<li class="toctree-l1"><a class="reference internal" href="questions.html">仍有问题？</a></li>
<li class="toctree-l1"><a class="reference internal" href="status.html">状态</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">hyperledger-fabricdocs</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="tutorials.html">教程</a> &raquo;</li>
        
      <li>链码开发者教程</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/chaincode4ade.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>链码开发者教程<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id2">
<h2>链码是什么?<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>链码是一段程序，由 <a class="reference external" href="https://golang.org">Go</a>  、 <a class="reference external" href="https://nodejs.org">node.js</a> 、或者`Java &lt;<a class="reference external" href="https://java.com/en/">https://java.com/en/</a>&gt;`_ 编写，来实现一些预定义的接口。链码运行在一个和背书节点分开的独立进程中，通过应用程序提交的交易来初始化和管理账本状态。</p>
<p>链码一般处理网络中的成员一致同意的商业逻辑，所以它类似于“智能合约”。链码可以在提案交易中被调用用来升级或者查询账本。赋予适当的权限，链码就可以调用其他链码访问它的状态，不管是在同一个通道还是不同的通道。注意，如果被调用链码和调用链码在不同的通道，就只能执行只读查询。就是说，调用不同通道的链码只能进行“查询”，在提交的子语句中不能参与状态的合法性检查。</p>
<p>在下边的章节中，我们站在应用开发者的角度来介绍链码。我们将演示一个简单的链码示例应用，并浏览 Chaincode Shim API 中每一个方法的作用。如果你是网络管理员，负责将链码部署在运行中的网络上，请查看 <a class="reference internal" href="deploy_chaincode.html"><span class="doc">}</span></a> 教程和 <a class="reference internal" href="chaincode_lifecycle.html"><span class="doc">&lt;no title&gt;</span></a> 概念主题。</p>
<p>本教程以底层视角提供 Fabric Chaincode Shim API 的概览。你也可以使用 Fabric Contract API 提供的高级 API。关于使用 Fabric Contract API 开发智能合约的更多信息，请访问 <a class="reference internal" href="developapps/smartcontract.html"><span class="doc">}</span></a> 主题。</p>
</div>
<div class="section" id="chaincode-api">
<h2>Chaincode API<a class="headerlink" href="#chaincode-api" title="Permalink to this headline">¶</a></h2>
<p>每一个链码程序都必须实现 <code class="docutils literal notranslate"><span class="pre">Chaincode</span></code> 接口，该接口的方法在接收
到交易时会被调用。你可以在下边找到不同语言 Chaincode Shim API 的参考文档：</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-chaincode-go/shim#Chaincode">Go</a></p></li>
<li><p><a class="reference external" href="https://hyperledger.github.io/fabric-chaincode-node/master/api/fabric-shim.ChaincodeInterface.html">Node.js</a></p></li>
<li><p><a class="reference external" href="https://hyperledger.github.io/fabric-chaincode-java/master/api/org/hyperledger/fabric/shim/Chaincode.html">Java</a></p></li>
</ul>
</div></blockquote>
<p>在每种语言中，客户端提交交易提案都会调用 <code class="docutils literal notranslate"><span class="pre">Invoke</span></code> 方法。该方法可以让你使用链码来读写通道账本上的数据。</p>
<p>你还要包含 <code class="docutils literal notranslate"><span class="pre">Init</span></code> 方法，该方法是实例化方法。该方法是链码接口需要的，你的应用程序没有必要调用。你可以使用 Fabric 链码生命周期过程来指定在 Invoke 之前是否必须调用 <code class="docutils literal notranslate"><span class="pre">Init</span></code> 方法。更多信息，请参考 Fabric 链码生命周期文档中 <a class="reference external" href="chaincode_lifecycle.html#step-three-approve-a-chaincode-definition-for-your-organization">批准链码定义</a> 步骤的实例化参数。</p>
<p>链码 “shim” API 中的其他接口是 <code class="docutils literal notranslate"><span class="pre">ChaincodeStubInterface</span></code>：</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-chaincode-go/shim#ChaincodeStubInterface">Go</a></p></li>
<li><p><a class="reference external" href="https://hyperledger.github.io/fabric-chaincode-node/master/api/fabric-shim.ChaincodeStub.html">Node.js</a></p></li>
<li><p><a class="reference external" href="https://hyperledger.github.io/fabric-chaincode-java/master/api/org/hyperledger/fabric/shim/ChaincodeStub.html">Java</a></p></li>
</ul>
</div></blockquote>
<p>用来访问和修改账本，以及在链码间发起调用。</p>
<p>在本教程中使用 Go 链码，我们将通过实现一个管理简单的“资产”示例链码应用来演示如何使用这些 API 。</p>
</div>
<div class="section" id="simple-asset-chaincode">
<span id="id3"></span><h2>简单资产链码<a class="headerlink" href="#simple-asset-chaincode" title="Permalink to this headline">¶</a></h2>
<p>我们的应用程序是一个基本的示例链码，用来在账本上创建资产（键-值对）。</p>
<div class="section" id="id4">
<h3>选择一个位置存放代码<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>如果你没有写过 Go 的程序，你可能需要确认一下你是否安装了 <a class="reference external" href="https://golang.org">Go</a> 以及你的系统是否配置正确。我们假设你用的是支持模块的版本。</p>
<p>现在你需要为你的链码应用程序创建一个目录。</p>
<p>简单起见，我们使用如下命令：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir sacc <span class="o">&amp;&amp;</span> <span class="nb">cd</span> sacc
</pre></div>
</div>
<p>现在，我们创建一个用于编写代码的源文件：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>go mod init sacc
touch sacc.go
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>内务<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>首先，我们从内务开始。每一个链码都要实现 <a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-chaincode-go/shim#Chaincode">Chaincode 接口</a> 中的 <code class="docutils literal notranslate"><span class="pre">Init</span></code> 和 <code class="docutils literal notranslate"><span class="pre">Invoke</span></code> 方法。所以，我们先使用 Go import 语句来导入链码必要的依赖。我们将导入链码 shim 包和 <a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-protos-go/peer">peer protobuf 包</a> 。然后，我们加入一个 <code class="docutils literal notranslate"><span class="pre">SimpleAsset</span></code> 结构体来作为 Chaincode shim 方法的接收者。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>

    <span class="s">&quot;github.com/hyperledger/fabric-chaincode-go/shim&quot;</span>
    <span class="s">&quot;github.com/hyperledger/fabric-protos-go/peer&quot;</span>
<span class="p">)</span>

<span class="c1">// SimpleAsset implements a simple chaincode to manage an asset</span>
<span class="kd">type</span> <span class="nx">SimpleAsset</span> <span class="kd">struct</span> <span class="p">{</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id7">
<h3>初始化链码<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>然后，我们将实现 <code class="docutils literal notranslate"><span class="pre">Init</span></code> 方法。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Init is called during chaincode instantiation to initialize any data.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">SimpleAsset</span><span class="p">)</span> <span class="nx">Init</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">peer</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>注意，链码升级的时候也要调用这个方法。当写一个用来升级已存在的链码的时候，请确保合理更改 <code class="docutils literal notranslate"><span class="pre">Init</span></code> 方法。特别地，当升级时没有“迁移”或者没东西需要初始化时，可以提供一个空的 <code class="docutils literal notranslate"><span class="pre">Init</span></code> 方法。</p>
</div>
<p>接下来，我们将使用 <a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-chaincode-go/shim#ChaincodeStub.GetStringArgs">ChaincodeStubInterface.GetStringArgs</a> 方法获取 <code class="docutils literal notranslate"><span class="pre">Init</span></code> 调用的参数，并且检查其合法性。在我们的用例中，我们希望得到一个键-值对。</p>
<blockquote>
<div><div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Init is called during chaincode instantiation to initialize any</span>
<span class="c1">// data. Note that chaincode upgrade also calls this function to reset</span>
<span class="c1">// or to migrate data, so be careful to avoid a scenario where you</span>
<span class="c1">// inadvertently clobber your ledger&#39;s data!</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">SimpleAsset</span><span class="p">)</span> <span class="nx">Init</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">peer</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>
  <span class="c1">// Get the args from the transaction proposal</span>
  <span class="nx">args</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">GetStringArgs</span><span class="p">()</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Error</span><span class="p">(</span><span class="s">&quot;Incorrect arguments. Expecting a key and a value&quot;</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>接下来，我们已经确定了调用是合法的，我们将把初始状态存入账本中。我们将调用
<a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-chaincode-go/shim#ChaincodeStub.PutState">ChaincodeStubInterface.PutState</a>
并将键和值作为参数传递给它。假设一切正常，将返回一个 peer.Response 对象，表明初始化成功。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Init is called during chaincode instantiation to initialize any</span>
<span class="c1">// data. Note that chaincode upgrade also calls this function to reset</span>
<span class="c1">// or to migrate data, so be careful to avoid a scenario where you</span>
<span class="c1">// inadvertently clobber your ledger&#39;s data!</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">SimpleAsset</span><span class="p">)</span> <span class="nx">Init</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">peer</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>
  <span class="c1">// Get the args from the transaction proposal</span>
  <span class="nx">args</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">GetStringArgs</span><span class="p">()</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Error</span><span class="p">(</span><span class="s">&quot;Incorrect arguments. Expecting a key and a value&quot;</span><span class="p">)</span>
  <span class="p">}</span>

  <span class="c1">// Set up any variables or assets here by calling stub.PutState()</span>

  <span class="c1">// We store the key and the value on the ledger</span>
  <span class="nx">err</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
  <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Error</span><span class="p">(</span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;Failed to create asset: %s&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Success</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3>调用链码<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>首先，我们增加一个 <code class="docutils literal notranslate"><span class="pre">Invoke</span></code> 函数的签名。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Invoke is called per transaction on the chaincode. Each transaction is</span>
<span class="c1">// either a &#39;get&#39; or a &#39;set&#39; on the asset created by Init function. The &#39;set&#39;</span>
<span class="c1">// method may create a new asset by specifying a new key-value pair.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">SimpleAsset</span><span class="p">)</span> <span class="nx">Invoke</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">peer</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>

<span class="p">}</span>
</pre></div>
</div>
<p>就像上边的 <code class="docutils literal notranslate"><span class="pre">Init</span></code> 函数一样，我们需要从 <code class="docutils literal notranslate"><span class="pre">ChaincodeStubInterface</span></code> 中解析参数。<code class="docutils literal notranslate"><span class="pre">Invoke</span></code> 函数的参数是将要调用的链码应用程序的函数名。在我们的用例中，我们的应用程序将有两个方法： <code class="docutils literal notranslate"><span class="pre">set</span></code> 和 <code class="docutils literal notranslate"><span class="pre">get</span></code> ，用来设置或者获取资产当前的状态。我们先调用 <a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-chaincode-go/shim#ChaincodeStub.GetFunctionAndParameters">ChaincodeStubInterface.GetFunctionAndParameters</a> 来为链码应用程序的方法解析方法名和参数。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Invoke is called per transaction on the chaincode. Each transaction is</span>
<span class="c1">// either a &#39;get&#39; or a &#39;set&#39; on the asset created by Init function. The Set</span>
<span class="c1">// method may create a new asset by specifying a new key-value pair.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">SimpleAsset</span><span class="p">)</span> <span class="nx">Invoke</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">peer</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>
    <span class="c1">// Extract the function and args from the transaction proposal</span>
    <span class="nx">fn</span><span class="p">,</span> <span class="nx">args</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">GetFunctionAndParameters</span><span class="p">()</span>

<span class="p">}</span>
</pre></div>
</div>
<p>然后，我们将验证函数名是否为 <code class="docutils literal notranslate"><span class="pre">set</span></code> 或者 <code class="docutils literal notranslate"><span class="pre">get</span></code> ，并执行链码应用程序的方法，通过 <code class="docutils literal notranslate"><span class="pre">shim.Success</span></code> 或 <code class="docutils literal notranslate"><span class="pre">shim.Error</span></code> 返回一个适当的响应，这个响应将被序列化为 gRPC protobuf 消息。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Invoke is called per transaction on the chaincode. Each transaction is</span>
<span class="c1">// either a &#39;get&#39; or a &#39;set&#39; on the asset created by Init function. The Set</span>
<span class="c1">// method may create a new asset by specifying a new key-value pair.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">SimpleAsset</span><span class="p">)</span> <span class="nx">Invoke</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">peer</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>
    <span class="c1">// Extract the function and args from the transaction proposal</span>
    <span class="nx">fn</span><span class="p">,</span> <span class="nx">args</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">GetFunctionAndParameters</span><span class="p">()</span>

    <span class="kd">var</span> <span class="nx">result</span> <span class="kt">string</span>
    <span class="kd">var</span> <span class="nx">err</span> <span class="kt">error</span>
    <span class="k">if</span> <span class="nx">fn</span> <span class="o">==</span> <span class="s">&quot;set&quot;</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">set</span><span class="p">(</span><span class="nx">stub</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">get</span><span class="p">(</span><span class="nx">stub</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Error</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">Error</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="c1">// Return the result as success payload</span>
    <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Success</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">result</span><span class="p">))</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3>实现链码应用程序<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>就像我们说的，我们的链码应用程序实现了两个功能，它们可以通过 <code class="docutils literal notranslate"><span class="pre">Invoke</span></code> 方法调用。我们现在来实现这些方法。注意我们之前提到的，要访问账本状态，我们需要使用链码 shim API 中的 <a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-chaincode-go/shim#ChaincodeStub.PutState">ChaincodeStubInterface.PutState</a>
和 <a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-chaincode-go/shim#ChaincodeStub.GetState">ChaincodeStubInterface.GetState</a> 方法。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="c1">// Set stores the asset (both key and value) on the ledger. If the key exists,</span>
<span class="c1">// it will override the value with the new one</span>
<span class="kd">func</span> <span class="nx">set</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">,</span> <span class="nx">args</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Incorrect arguments. Expecting a key and a value&quot;</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">err</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Failed to set asset: %s&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// Get returns the value of the specified asset key</span>
<span class="kd">func</span> <span class="nx">get</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">,</span> <span class="nx">args</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Incorrect arguments. Expecting a key&quot;</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">value</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">GetState</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Failed to get asset: %s with error: %s&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nx">value</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Asset not found: %s&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">string</span><span class="p">(</span><span class="nx">value</span><span class="p">),</span> <span class="kc">nil</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="chaincode-sample">
<span id="id11"></span><h3>把它们组合在一起<a class="headerlink" href="#chaincode-sample" title="Permalink to this headline">¶</a></h3>
<p>最后，我们增加一个 <code class="docutils literal notranslate"><span class="pre">main</span></code> 方法，它将调用
<a class="reference external" href="https://godoc.org/github.com/hyperledger/fabric-chaincode-go/shim#Start">shim.Start</a> 方法。下边是我们链码程序的完整源码。</p>
<div class="highlight-go notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span> <span class="nx">main</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&quot;fmt&quot;</span>

    <span class="s">&quot;github.com/hyperledger/fabric-chaincode-go/shim&quot;</span>
    <span class="s">&quot;github.com/hyperledger/fabric-protos-go/peer&quot;</span>
<span class="p">)</span>

<span class="c1">// SimpleAsset implements a simple chaincode to manage an asset</span>
<span class="kd">type</span> <span class="nx">SimpleAsset</span> <span class="kd">struct</span> <span class="p">{</span>
<span class="p">}</span>

<span class="c1">// Init is called during chaincode instantiation to initialize any</span>
<span class="c1">// data. Note that chaincode upgrade also calls this function to reset</span>
<span class="c1">// or to migrate data.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">SimpleAsset</span><span class="p">)</span> <span class="nx">Init</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">peer</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>
    <span class="c1">// Get the args from the transaction proposal</span>
    <span class="nx">args</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">GetStringArgs</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Error</span><span class="p">(</span><span class="s">&quot;Incorrect arguments. Expecting a key and a value&quot;</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="c1">// Set up any variables or assets here by calling stub.PutState()</span>

    <span class="c1">// We store the key and the value on the ledger</span>
    <span class="nx">err</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Error</span><span class="p">(</span><span class="nx">fmt</span><span class="p">.</span><span class="nx">Sprintf</span><span class="p">(</span><span class="s">&quot;Failed to create asset: %s&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Success</span><span class="p">(</span><span class="kc">nil</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Invoke is called per transaction on the chaincode. Each transaction is</span>
<span class="c1">// either a &#39;get&#39; or a &#39;set&#39; on the asset created by Init function. The Set</span>
<span class="c1">// method may create a new asset by specifying a new key-value pair.</span>
<span class="kd">func</span> <span class="p">(</span><span class="nx">t</span> <span class="o">*</span><span class="nx">SimpleAsset</span><span class="p">)</span> <span class="nx">Invoke</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">)</span> <span class="nx">peer</span><span class="p">.</span><span class="nx">Response</span> <span class="p">{</span>
    <span class="c1">// Extract the function and args from the transaction proposal</span>
    <span class="nx">fn</span><span class="p">,</span> <span class="nx">args</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">GetFunctionAndParameters</span><span class="p">()</span>

    <span class="kd">var</span> <span class="nx">result</span> <span class="kt">string</span>
    <span class="kd">var</span> <span class="nx">err</span> <span class="kt">error</span>
    <span class="k">if</span> <span class="nx">fn</span> <span class="o">==</span> <span class="s">&quot;set&quot;</span> <span class="p">{</span>
            <span class="nx">result</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">set</span><span class="p">(</span><span class="nx">stub</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span> <span class="c1">// assume &#39;get&#39; even if fn is nil</span>
            <span class="nx">result</span><span class="p">,</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">get</span><span class="p">(</span><span class="nx">stub</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Error</span><span class="p">(</span><span class="nx">err</span><span class="p">.</span><span class="nx">Error</span><span class="p">())</span>
    <span class="p">}</span>

    <span class="c1">// Return the result as success payload</span>
    <span class="k">return</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Success</span><span class="p">([]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">result</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1">// Set stores the asset (both key and value) on the ledger. If the key exists,</span>
<span class="c1">// it will override the value with the new one</span>
<span class="kd">func</span> <span class="nx">set</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">,</span> <span class="nx">args</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Incorrect arguments. Expecting a key and a value&quot;</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">err</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">PutState</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[]</span><span class="nb">byte</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Failed to set asset: %s&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nx">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// Get returns the value of the specified asset key</span>
<span class="kd">func</span> <span class="nx">get</span><span class="p">(</span><span class="nx">stub</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">ChaincodeStubInterface</span><span class="p">,</span> <span class="nx">args</span> <span class="p">[]</span><span class="kt">string</span><span class="p">)</span> <span class="p">(</span><span class="kt">string</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nx">args</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Incorrect arguments. Expecting a key&quot;</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="nx">value</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">stub</span><span class="p">.</span><span class="nx">GetState</span><span class="p">(</span><span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Failed to get asset: %s with error: %s&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nx">value</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="nx">fmt</span><span class="p">.</span><span class="nx">Errorf</span><span class="p">(</span><span class="s">&quot;Asset not found: %s&quot;</span><span class="p">,</span> <span class="nx">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nb">string</span><span class="p">(</span><span class="nx">value</span><span class="p">),</span> <span class="kc">nil</span>
<span class="p">}</span>

<span class="c1">// main function starts up the chaincode in the container during instantiate</span>
<span class="kd">func</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">shim</span><span class="p">.</span><span class="nx">Start</span><span class="p">(</span><span class="nb">new</span><span class="p">(</span><span class="nx">SimpleAsset</span><span class="p">));</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="nx">fmt</span><span class="p">.</span><span class="nx">Printf</span><span class="p">(</span><span class="s">&quot;Error starting SimpleAsset chaincode: %s&quot;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id12">
<h2>链码访问控制<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<p>链码可以通过调用 GetCreator() 方法来使用客户端（提交者）证书进行访问控制决策。另外，Go shim 提供了扩展 API ，用于从提交者的证书中提取客户端标识用于访问控制决策，该证书可以是客户端身份本身，或者组织身份，或客户端身份属性。</p>
<p>例如，一个以键-值对表示的资产可以将客户端的身份作为值的一部分保存其中（比如以 JSON 属性标识资产主人），以后就只有被授权的客户端才可以更新键-值对。</p>
<p>详细信息请查阅 <a class="reference external" href="https://github.com/hyperledger/fabric-chaincode-go/blob/master/pkg/cid/README.md">client identity (CID) library documentation</a></p>
<p>To add the client identity shim extension to your chaincode as a dependency, see <a class="reference internal" href="#vendoring"><span class="std std-ref">管理 Go 链码的扩展依赖</span></a>.</p>
<p>将客户端身份 shim 扩展作为依赖添加到你的链码，请查阅 <a class="reference internal" href="#vendoring"><span class="std std-ref">管理 Go 链码的扩展依赖</span></a> 。</p>
</div>
<div class="section" id="vendoring">
<span id="id13"></span><h2>管理 Go 链码的扩展依赖<a class="headerlink" href="#vendoring" title="Permalink to this headline">¶</a></h2>
<p>你的 Go 链码需要 Go 标准库之外的一些依赖包（比如链码 shim）。当链码安装到 peer 的时候，这些报的源码必须被包含在你的链码包中。如果你将你的链码构造为一个模块，最简单的方法就是在打包你的链码之前使用 <code class="docutils literal notranslate"><span class="pre">go</span> <span class="pre">mod</span> <span class="pre">vendor</span></code> 来 “vendor” 依赖。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>go mod tidy
go mod vendor
</pre></div>
</div>
<p>这就把你链码的扩展依赖放进了本地的 <code class="docutils literal notranslate"><span class="pre">vendor</span></code> 目录。</p>
<p>当依赖都引入到你的链码目录后， <code class="docutils literal notranslate"><span class="pre">peer</span> <span class="pre">chaincode</span> <span class="pre">package</span></code> 和 <code class="docutils literal notranslate"><span class="pre">peer</span> <span class="pre">chaincode</span> <span class="pre">install</span></code> 操作将把这些依赖一起放入链码包中。</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="videos.html" class="btn btn-neutral float-right" title="视频" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="config_update.html" class="btn btn-neutral" title="&lt;no title&gt;" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright Hyperledger 2020.
    <br>
      <br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
      <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
        <img alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a>

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>